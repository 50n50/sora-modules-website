<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sora Modules</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Homepage View -->
        <div id="homepage">
            <h1>Sora Modules</h1>
            <p>Select a module:</p> 
            <div class="modules-grid" id="websiteGrid">
                <!-- Websites will be loaded here dynamically -->
            </div>
        </div>

        <!-- Redirect View -->
        <div id="redirectContent" class="redirect-container">
            <div class="loading"></div>
            <p>Opening in Sora app...</p>
            <div class="link-display" id="linkDisplay"></div>
            <button class="button" onclick="copyLink()">Copy Link</button>
            <a href="/" class="button">Back to Home</a>
            <p class="success-message" id="successMessage">Link copied successfully!</p>
        </div>
    </div>

    <script>
        // Website configurations
        const websites = {
            'aniwatch': {
                name: 'AniWatch',
                baseUrl: 'https://raw.githubusercontent.com/50n50/sources/refs/heads/main/hianime/hianime.json',
                redirectUrl: 'sora://module?url=https://raw.githubusercontent.com/50n50/sources/refs/heads/main/hianime/hianime.json',
                description: 'Language: English'
            },
            // Add more websites here
        };

        // Function to create website cards
        function createWebsiteCards() {
            const grid = document.getElementById('websiteGrid');
            
            for (const [id, website] of Object.entries(websites)) {
                const card = document.createElement('div');
                card.className = 'module-card';
                card.onclick = () => handleRedirect(website.redirectUrl, website.baseUrl);
                
                card.innerHTML = `
                    <h3 class="module-title">${website.name}</h3>
                    <p class="module-description">${website.description}</p>
                `;
                
                grid.appendChild(card);
            }
        }

        // Function to handle redirect
        function handleRedirect(redirectUrl, baseUrl) {
            // Show redirect content and hide homepage
            document.getElementById('homepage').style.display = 'none';
            document.getElementById('redirectContent').style.display = 'block';
            
            // Set the link display
            const linkDisplay = document.getElementById('linkDisplay');
            linkDisplay.textContent = baseUrl;
            
            // Attempt to open the app
            window.location.href = redirectUrl;
            
            // Show the link display after a short delay (in case redirect fails)
            setTimeout(() => {
                linkDisplay.style.display = 'block';
            }, 1500);
        }

        // Function to copy link
        function copyLink() {
            const linkText = document.getElementById('linkDisplay').textContent;
            navigator.clipboard.writeText(linkText).then(() => {
                const successMessage = document.getElementById('successMessage');
                successMessage.style.display = 'block';
                setTimeout(() => {
                    successMessage.style.display = 'none';
                }, 2000);
            });
        }

        // Initialize website cards when the page loads
        document.addEventListener('DOMContentLoaded', createWebsiteCards);

        // Check if we're on a direct website URL
        const path = window.location.pathname;
        const websiteId = path.split('/').pop().replace('.json', '');
        if (websites[websiteId]) {
            handleRedirect(websites[websiteId].redirectUrl, websites[websiteId].baseUrl);
        }
    </script>
</body>
</html> 
